From 376c4014719209047cea6e46d2367f5a1e763e9a Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Fri, 23 Apr 2021 11:12:09 -0500
Subject: [PATCH] enable: Jenkins: http://gfnd.rcn-ee.org:8080

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 .github/FUNDING.yml                  | 12 ++++++
 .github/ISSUE_TEMPLATE/bug_report.md | 20 ++++++++++
 Jenkinsfile                          | 11 ++++++
 README.md                            |  6 +++
 jenkins_build.sh                     | 58 ++++++++++++++++++++++++++++
 5 files changed, 107 insertions(+)
 create mode 100644 .github/FUNDING.yml
 create mode 100644 .github/ISSUE_TEMPLATE/bug_report.md
 create mode 100644 Jenkinsfile
 create mode 100644 README.md
 create mode 100755 jenkins_build.sh

diff --git a/.github/FUNDING.yml b/.github/FUNDING.yml
new file mode 100644
index 000000000000..8b20af1e3599
--- /dev/null
+++ b/.github/FUNDING.yml
@@ -0,0 +1,12 @@
+# These are supported funding model platforms
+
+github: beagleboard # Replace with up to 4 GitHub Sponsors-enabled usernames e.g., [user1, user2]
+patreon: beagleboard # Replace with a single Patreon username
+open_collective: # Replace with a single Open Collective username
+ko_fi: # Replace with a single Ko-fi username
+tidelift: # Replace with a single Tidelift platform-name/package-name e.g., npm/babel
+community_bridge: # Replace with a single Community Bridge project-name e.g., cloud-foundry
+liberapay: # Replace with a single Liberapay username
+issuehunt: # Replace with a single IssueHunt username
+otechie: # Replace with a single Otechie username
+custom: https://paypal.me/beagleboard # Replace with up to 4 custom sponsorship URLs e.g., ['link1', 'link2']
diff --git a/.github/ISSUE_TEMPLATE/bug_report.md b/.github/ISSUE_TEMPLATE/bug_report.md
new file mode 100644
index 000000000000..94be17e338b3
--- /dev/null
+++ b/.github/ISSUE_TEMPLATE/bug_report.md
@@ -0,0 +1,20 @@
+---
+name: Bug report
+about: Create a report to help us improve
+title: ''
+labels: ''
+assignees: ''
+
+---
+
+**Describe the bug**
+A clear and concise description of what the bug is.
+
+**Describe how to reproduce the bug**
+List all the steps needed to reproduce the bug
+
+**REQUIRED INFORMATION**
+Run this command and paste the output here:
+```
+sudo /opt/scripts/tools/version.sh
+```
diff --git a/Jenkinsfile b/Jenkinsfile
new file mode 100644
index 000000000000..5d5776ff0e8b
--- /dev/null
+++ b/Jenkinsfile
@@ -0,0 +1,11 @@
+pipeline {
+    agent { label 'amd64'}
+
+    stages {
+        stage('Build') {
+            steps {
+                sh '/bin/bash ./jenkins_build.sh'
+            }
+        }
+    }
+}
diff --git a/README.md b/README.md
new file mode 100644
index 000000000000..665d2e59354f
--- /dev/null
+++ b/README.md
@@ -0,0 +1,6 @@
+| kernel | normal | rt | xenomai |
+|:---:|:---:|:---:|:---:|
+|4.14 | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.14/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.14/) | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.14-rt/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.14-rt/) | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.14-xenomai/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.14-xenomai/) |
+|4.19 | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.19/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.19/) | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.19-rt/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.19-rt/) | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.19-xenomai/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/4.19-xenomai/) |
+|5.4 | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.4/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.4/) | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.4-rt/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.4-rt/) | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.4-xenomai/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.4-xenomai/) |
+|5.10 | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.10/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.10/) | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.10-rt/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.10-rt/) | [![Build Status](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.10-xenomai/badge/icon)](http://gfnd.rcn-ee.org:8080/view/BeagleBoard/job/beagleboard_kernel_builder/job/5.10-xenomai/) |
diff --git a/jenkins_build.sh b/jenkins_build.sh
new file mode 100755
index 000000000000..ca0cc1b77ceb
--- /dev/null
+++ b/jenkins_build.sh
@@ -0,0 +1,58 @@
+#!/bin/bash
+
+#gcc:
+
+#
+#https://developer.arm.com/-/media/Files/downloads/gnu-a/8.2-2018.08/gcc-arm-8.2-2018.08-x86_64-arm-linux-gnueabihf.tar.xz
+#https://developer.arm.com/-/media/Files/downloads/gnu-a/8.2-2018.11/gcc-arm-8.2-2018.11-x86_64-arm-linux-gnueabihf.tar.xz
+#https://developer.arm.com/-/media/Files/downloads/gnu-a/8.2-2019.01/gcc-arm-8.2-2019.01-x86_64-arm-linux-gnueabihf.tar.xz
+#https://developer.arm.com/-/media/Files/downloads/gnu-a/8.3-2019.03/binrel/gcc-arm-8.3-2019.03-x86_64-arm-linux-gnueabihf.tar.x
+#
+
+gcc_html_path="https://developer.arm.com/-/media/Files/downloads/gnu-a/8.3-2019.03/binrel/"
+gcc_filename_prefix="gcc-arm-8.3-2019.03-x86_64-arm-linux-gnueabihf"
+gcc_banner="arm-linux-gnueabihf-gcc (GNU Toolchain for the A-profile Architecture 8.3-2019.03 (arm-rel-8.36)) 8.3.0"
+gcc_copyright="2018"
+datestamp="2019.03-gcc-arm-linux-gnueabihf"
+
+if [ ! -d ${gcc_filename_prefix}/ ] ; then
+	rm -rf ./gcc-* || true
+	#wget -c ${site}/${version}/${filename}
+	wget -c http://192.168.3.125/jenkins/gcc-arm-8.3-2019.03-x86_64-arm-linux-gnueabihf.tar.x
+	tar xf ${gcc_filename_prefix}.tar.xz
+fi
+
+export CC=`pwd`/${gcc_filename_prefix}/bin/arm-linux-gnueabihf-
+
+make ARCH=arm clean
+make ARCH=arm bb.org_defconfig
+
+echo "[make ARCH=arm -j4 CROSS_COMPILE=\"${binary}\" zImage]"
+make ARCH=arm -j4 CROSS_COMPILE="ccache ${CC}" zImage
+if [ ! -f arch/arm/boot/zImage ] ; then
+	echo "failed: [arch/arm/boot/zImage]"
+	exit 1
+fi
+
+echo "[make ARCH=arm -j4 CROSS_COMPILE=\"${binary}\" modules]"
+make ARCH=arm -j4 CROSS_COMPILE="ccache ${CC}" modules
+if [ ! -f drivers/spi/spidev.ko ] ; then
+	echo "failed: [drivers/spi/spidev.ko]"
+	exit 1
+fi
+
+echo "[make ARCH=arm CROSS_COMPILE=\"${binary}\" dtbs]"
+make ARCH=arm CROSS_COMPILE="ccache ${CC}" dtbs
+if [ ! -f arch/arm/boot/dts/am335x-boneblack.dtb ] ; then
+	echo "failed: [arch/arm/boot/dts/am335x-boneblack.dtb]"
+	exit 1
+else
+	if [ -f arch/arm/boot/dts/am335x-pocketbeagle.dts ] ; then
+		if [ ! -f arch/arm/boot/dts/am335x-pocketbeagle.dtb ] ; then
+			echo "failed: [arch/arm/boot/dts/am335x-pocketbeagle.dtb]"
+			exit 1
+		fi
+	fi
+fi
+
+make ARCH=arm clean
-- 
2.30.2

